!function(e){e(function(){function i(){var i={body:e("body"),revenueModel:".lp_js_revenueModel",revenueModelLabel:".lp_js_revenueModelLabel",revenueModelLabelDisplay:".lp_js_revenueModelLabelDisplay",revenueModelInput:".lp_js_revenueModelInput",priceInput:".lp_js_priceInput",emptyState:".lp_js_emptyState",purchaseModeForm:e("#lp_js_changePurchaseModeForm"),purchaseModeInput:e(".lp_js_onlyTimePassPurchaseModeInput"),timePassOnlyHideElements:e(".lp_js_hideInTimePassOnlyMode"),globalDefaultPriceForm:e("#lp_js_globalDefaultPriceForm"),globalDefaultPriceInput:e("#lp_js_globalDefaultPriceInput"),globalDefaultPriceDisplay:e("#lp_js_globalDefaultPriceDisplay"),globalDefaultPriceRevenueModelDisplay:e("#lp_js_globalDefaultPriceRevenueModelDisplay"),editGlobalDefaultPrice:e("#lp_js_editGlobalDefaultPrice"),cancelEditingGlobalDefaultPrice:e("#lp_js_cancelEditingGlobalDefaultPrice"),saveGlobalDefaultPrice:e("#lp_js_saveGlobalDefaultPrice"),globalDefaultPriceShowElements:e("#lp_js_globalDefaultPriceShowElements"),globalDefaultPriceEditElements:e("#lp_js_globalDefaultPriceEditElements"),categoryDefaultPrices:e("#lp_js_categoryDefaultPriceList"),addCategory:e("#lp_js_addCategoryDefaultPrice"),categoryDefaultPriceTemplate:e("#lp_js_categoryDefaultPriceTemplate"),categoryDefaultPriceForm:".lp_js_categoryDefaultPriceForm",editCategoryDefaultPrice:".lp_js_editCategoryDefaultPrice",cancelEditingCategoryDefaultPrice:".lp_js_cancelEditingCategoryDefaultPrice",saveCategoryDefaultPrice:".lp_js_saveCategoryDefaultPrice",deleteCategoryDefaultPrice:".lp_js_deleteCategoryDefaultPrice",categoryDefaultPriceShowElements:".lp_js_categoryDefaultPriceShowElements",categoryDefaultPriceEditElements:".lp_js_categoryDefaultPriceEditElements",categoryTitle:".lp_js_categoryDefaultPriceCategoryTitle",categoryDefaultPriceDisplay:".lp_js_categoryDefaultPriceDisplay",selectCategory:".lp_js_selectCategory",categoryDefaultPriceInput:".lp_js_categoryDefaultPriceInput",categoryId:".lp_js_categoryDefaultPriceCategoryId",timepass:{editor:e("#lp_time-passes"),template:e("#lp_js_timePassTemplate"),form:".lp_js_timePassEditorForm",editorContainer:".lp_js_timePassEditorContainer",id:".lp_js_timePassId",wrapper:".lp_js_timePassWrapper",categoryWrapper:".lp_js_timePassCategoryWrapper",fields:{duration:".lp_js_switchTimePassDuration",period:".lp_js_switchTimePassPeriod",scope:".lp_js_switchTimePassScope",scopeCategory:".lp_js_switchTimePassScopeCategory",categoryId:".lp_js_timePassCategoryId",title:".lp_js_timePassTitleInput",price:".lp_js_timePassPriceInput",revenueModel:".lp_js_timePassRevenueModelInput",description:".lp_js_timePassDescriptionTextarea"},classes:{form:"lp_js_timePassForm",editorForm:"lp_js_timePassEditorForm",durationClass:"lp_js_switchTimePassDuration",titleClass:"lp_js_timePassTitleInput",priceClass:"lp_js_timePassPriceInput",descriptionClass:"lp_js_timePassDescriptionTextarea",periodClass:"lp_js_switchTimePassPeriod",scopeClass:"lp_js_switchTimePassScope",scopeCategoryClass:"lp_js_switchTimePassScopeCategory"},preview:{placeholder:".lp_js_timePassPreview",wrapper:".lp_js_timePass",title:".lp_js_timePassPreviewTitle",description:".lp_js_timePassPreviewDescription",validity:".lp_js_timePassPreviewValidity",access:".lp_js_timePassPreviewAccess",price:".lp_js_timePassPreviewPrice"},actions:{create:e("#lp_js_addTimePass"),show:".lp_js_saveTimePass, .lp_js_cancelEditingTimePass",modify:".lp_js_editTimePass, .lp_js_deleteTimePass",save:".lp_js_saveTimePass",cancel:".lp_js_cancelEditingTimePass","delete":".lp_js_deleteTimePass",edit:".lp_js_editTimePass",flip:".lp_js_flipTimePass"},ajax:{form:{"delete":"time_pass_delete"}},data:{id:"pass-id",list:lpVars.time_passes_list,vouchers:lpVars.vouchers_list,deleteConfirm:lpVars.i18n.confirmDeleteTimepass,fields:{id:"pass_id"}}},subscription:{editor:e("#lp_subscriptions"),template:e("#lp_js_subscriptionTemplate"),form:".lp_js_subscriptionEditorForm",editorContainer:".lp_js_subscriptionEditorContainer",id:".lp_js_subscriptionId",wrapper:".lp_js_subscriptionWrapper",categoryWrapper:".lp_js_subscriptionCategoryWrapper",fields:{duration:".lp_js_switchSubscriptionDuration",period:".lp_js_switchSubscriptionPeriod",scope:".lp_js_switchSubscriptionScope",scopeCategory:".lp_js_switchSubscriptionScopeCategory",categoryId:".lp_js_subscriptionCategoryId",title:".lp_js_subscriptionTitleInput",price:".lp_js_subscriptionPriceInput",description:".lp_js_subscriptionDescriptionTextarea"},classes:{form:"lp_js_subscriptionForm",editorForm:"lp_js_subscriptionEditorForm",durationClass:"lp_js_switchSubscriptionDuration",titleClass:"lp_js_subscriptionTitleInput",priceClass:"lp_js_subscriptionPriceInput",descriptionClass:"lp_js_subscriptionDescriptionTextarea",periodClass:"lp_js_switchSubscriptionPeriod",scopeClass:"lp_js_switchSubscriptionScope",scopeCategoryClass:"lp_js_switchSubscriptionScopeCategory"},preview:{placeholder:".lp_js_subscriptionPreview",wrapper:".lp_js_subscription",title:".lp_js_subscriptionPreviewTitle",description:".lp_js_subscriptionPreviewDescription",validity:".lp_js_subscriptionPreviewValidity",access:".lp_js_subscriptionPreviewAccess",price:".lp_js_subscriptionPreviewPrice",renewal:".lp_js_subscriptionPreviewRenewal"},actions:{create:e("#lp_js_addSubscription"),show:".lp_js_saveSubscription, .lp_js_cancelEditingSubscription",modify:".lp_js_editSubscription, .lp_js_deleteSubscription",save:".lp_js_saveSubscription",edit:".lp_js_editSubscription",cancel:".lp_js_cancelEditingSubscription","delete":".lp_js_deleteSubscription",flip:".lp_js_flipSubscription"},ajax:{form:{"delete":"subscription_delete"}},data:{id:"sub-id",list:lpVars.subscriptions_list,deleteConfirm:lpVars.i18n.confirmDeleteSubscription,fields:{id:"id"}}},voucherPriceInput:".lp_js_voucherPriceInput",generateVoucherCode:".lp_js_generateVoucherCode",voucherDeleteLink:".lp_js_deleteVoucher",voucherEditor:".lp_js_voucherEditor",voucherHiddenPassId:"#lp_js_timePassEditorHiddenPassId",voucherPlaceholder:".lp_js_voucherPlaceholder",voucherList:".lp_js_voucherList",voucher:".lp_js_voucher",voucherTimesRedeemed:".lp_js_voucherTimesRedeemed",editing:"lp_is-editing",unsaved:"lp_is-unsaved",payPerUse:"ppu",singleSale:"sis",selected:"lp_is-selected",disabled:"lp_is-disabled",hidden:"lp_hidden",navigation:e(".lp_navigation")},s=function(){i.body.on("change",i.revenueModelInput,function(){t(e(this).parents("form"))}),i.body.on("keyup",i.priceInput,V(function(){t(e(this).parents("form"))},800)),i.purchaseModeInput.on("change",function(){E(i.purchaseModeForm)}),i.editGlobalDefaultPrice.on("mousedown",function(){r()}).click(function(e){e.preventDefault()}),i.cancelEditingGlobalDefaultPrice.on("mousedown",function(){o()}).click(function(e){e.preventDefault()}),i.saveGlobalDefaultPrice.on("mousedown",function(){n()}).click(function(e){e.preventDefault()}),i.addCategory.on("mousedown",function(){l()}).click(function(e){e.preventDefault()}),i.body.on("click",i.editCategoryDefaultPrice,function(){var s=e(this).parents(i.categoryDefaultPriceForm);c(s)}),i.body.on("click",i.cancelEditingCategoryDefaultPrice,function(){var s=e(this).parents(i.categoryDefaultPriceForm);u(s)}),i.body.on("click",i.saveCategoryDefaultPrice,function(){var s=e(this).parents(i.categoryDefaultPriceForm);p(s)}),i.body.on("click",i.deleteCategoryDefaultPrice,function(){var s=e(this).parents(i.categoryDefaultPriceForm);d(s)}),i.timepass.actions.create.on("mousedown",function(){v("timepass")}).on("click",function(e){e.preventDefault()}),i.timepass.editor.on("mousedown",i.timepass.actions.edit,function(){h("timepass",e(this).parents(i.timepass.wrapper))}).on("click",i.timepass.actions.edit,function(e){e.preventDefault()}),i.timepass.editor.on("change",i.timepass.fields.revenueModel,function(){var s=e(this).parents("form");t(s,!1,e(i.timepass.fields.price,s))}),i.timepass.editor.on("change",i.timepass.fields.duration,function(){g("timepass",e(this).parents(i.timepass.wrapper),e(this))}),i.timepass.editor.on("change",i.timepass.fields.period,function(){C("timepass",e(this),e(this).parents(i.timepass.wrapper)),g("timepass",e(this).parents(i.timepass.wrapper),e(this))}),i.timepass.editor.on("change",i.timepass.fields.scope,function(){w("timepass",e(this)),g("timepass",e(this).parents(i.timepass.wrapper),e(this))}),i.timepass.editor.on("change",i.timepass.fields.scopeCategory,function(){g("timepass",e(this).parents(i.timepass.wrapper),e(this))}),i.timepass.editor.on("input",[i.timepass.fields.title,i.timepass.fields.description].join(),function(){g("timepass",e(this).parents(i.timepass.wrapper),e(this))}),i.timepass.editor.on("keyup",i.timepass.fields.price,V(function(){t(e(this).parents("form"),!1,e(this)),g("timepass",e(this).parents(i.timepass.wrapper),e(this))},800)),i.timepass.editor.on("click",i.timepass.actions.cancel,function(s){b("timepass",e(this).parents(i.timepass.wrapper)),s.preventDefault()}),i.timepass.editor.on("click",i.timepass.actions.save,function(s){P("timepass",e(this).parents(i.timepass.wrapper)),s.preventDefault()}),i.timepass.editor.on("click",i.timepass.actions["delete"],function(s){j("timepass",e(this).parents(i.timepass.wrapper)),s.preventDefault()}),i.timepass.editor.on("mousedown",i.timepass.actions.flip,function(){D("timepass",this)}).on("click",i.timepass.actions.flip,function(e){e.preventDefault()}),i.timepass.editor.on("keyup",i.voucherPriceInput,V(function(){t(e(this).parents("form"),!0,e(this))},800)),i.timepass.editor.on("mousedown",i.generateVoucherCode,function(){x(e(this).parents(i.timepass.wrapper))}).on("click",i.generateVoucherCode,function(e){e.preventDefault()}),i.timepass.editor.on("click",i.voucherDeleteLink,function(i){M(e(this).parent()),i.preventDefault()}),i.subscription.actions.create.on("mousedown",function(){v("subscription")}).on("click",function(e){e.preventDefault()}),i.subscription.editor.on("mousedown",i.subscription.actions.edit,function(){h("subscription",e(this).parents(i.subscription.wrapper))}).on("click",i.subscription.actions.edit,function(e){e.preventDefault()}),i.subscription.editor.on("change",i.subscription.fields.duration,function(){g("subscription",e(this).parents(i.subscription.wrapper),e(this))}),i.subscription.editor.on("change",i.subscription.fields.period,function(){C("subscription",e(this),e(this).parents(i.subscription.wrapper)),g("subscription",e(this).parents(i.subscription.wrapper),e(this))}),i.subscription.editor.on("change",i.subscription.fields.scope,function(){w("subscription",e(this)),g("subscription",e(this).parents(i.subscription.wrapper),e(this))}),i.subscription.editor.on("change",i.subscription.fields.scopeCategory,function(){g("subscription",e(this).parents(i.subscription.wrapper),e(this))}),i.subscription.editor.on("input",[i.subscription.fields.title,i.subscription.fields.description].join(),function(){g("subscription",e(this).parents(i.subscription.wrapper),e(this))}),i.subscription.editor.on("keyup",i.subscription.fields.price,V(function(){t(e(this).parents("form"),!0,e(this),!0),g("subscription",e(this).parents(i.subscription.wrapper),e(this))},1e3)),i.subscription.editor.on("click",i.subscription.actions.cancel,function(s){b("subscription",e(this).parents(i.subscription.wrapper)),s.preventDefault()}),i.subscription.editor.on("click",i.subscription.actions.save,function(s){P("subscription",e(this).parents(i.subscription.wrapper)),s.preventDefault()}),i.subscription.editor.on("click",i.subscription.actions["delete"],function(s){j("subscription",e(this).parents(i.subscription.wrapper)),s.preventDefault()}),i.subscription.editor.on("mousedown",i.subscription.actions.flip,function(){D("subscription",this)}).on("click",i.subscription.actions.flip,function(e){e.preventDefault()})},t=function(i,s,t,r){var o=t?t:e(".lp_number-input",i),n=o.val();return n=n.replace(/[^0-9\,\.]/g,""),n=parseFloat(n.replace(",",".")).toFixed(2),isNaN(n)&&(n=0),n=Math.abs(n),r?n<lpVars.currency.sis_min?n=lpVars.currency.sis_min:n>lpVars.currency.sis_max&&(n=lpVars.currency.sis_max):n>lpVars.currency.sis_max?n=lpVars.currency.sis_max:n>0&&n<lpVars.currency.ppu_min&&(n=lpVars.currency.ppu_min),s||a(n,i),n=n.toFixed(2),lpVars.locale.indexOf("de_DE")!==-1&&(n=n.replace(".",",")),o.val(n),n},a=function(s,t){var a,r=i.revenueModelInput;t.hasClass(i.timepass.classes.editorForm)&&(r=i.timepass.fields.revenueModel);var o=e(r+"[value="+i.payPerUse+"]",t),n=e(r+"[value="+i.singleSale+"]",t);a=e("input:radio:checked",t).val(),0===s||s>=lpVars.currency.ppu_min&&s<=lpVars.currency.ppu_max?o.removeProp("disabled").parent("label").removeClass(i.disabled):o.prop("disabled","disabled").parent("label").addClass(i.disabled),s>=lpVars.currency.sis_min?n.removeProp("disabled").parent("label").removeClass(i.disabled):n.prop("disabled","disabled").parent("label").addClass(i.disabled),s>lpVars.currency.ppu_max&&a===i.payPerUse?n.prop("checked","checked"):s<lpVars.currency.sis_min&&a===i.singleSale&&o.prop("checked","checked"),e("label",t).removeClass(i.selected),e(r+":checked",t).parent("label").addClass(i.selected)},r=function(){i.globalDefaultPriceShowElements.velocity("slideUp",{duration:250,easing:"ease-out"}),i.globalDefaultPriceEditElements.velocity("slideDown",{duration:250,easing:"ease-out",complete:function(){setTimeout(function(){i.globalDefaultPriceInput.focus()},50)}}),i.globalDefaultPriceForm.addClass(i.editing)},o=function(){i.globalDefaultPriceShowElements.velocity("slideDown",{duration:250,easing:"ease-out"}),i.globalDefaultPriceEditElements.velocity("slideUp",{duration:250,easing:"ease-out"}),i.globalDefaultPriceForm.removeClass(i.editing),i.globalDefaultPriceInput.val(i.globalDefaultPriceDisplay.data("price"));var s=i.globalDefaultPriceRevenueModelDisplay.data("revenue");e(i.revenueModelLabel,i.globalDefaultPriceForm).removeClass(i.selected),e(".lp_js_revenueModelInput[value="+s+"]",i.globalDefaultPriceForm).prop("checked","checked").parent("label").addClass(i.selected)},n=function(){var s=t(i.globalDefaultPriceForm);i.globalDefaultPriceInput.val(s),e.post(ajaxurl,i.globalDefaultPriceForm.serializeArray(),function(e){e.success&&(i.globalDefaultPriceDisplay.text(e.localized_price).data("price",e.price),i.globalDefaultPriceRevenueModelDisplay.text(e.revenue_model_label).data("revenue",e.revenue_model)),i.navigation.showMessage(e),o()},"json")},l=function(){i.addCategory.velocity("fadeOut",{duration:250}),e(i.emptyState,i.categoryDefaultPrices).is(":visible")&&e(i.emptyState,i.categoryDefaultPrices).velocity("fadeOut",{duration:400});var s=i.categoryDefaultPriceTemplate.clone().removeAttr("id").insertBefore("#lp_js_categoryDefaultPriceList").velocity("slideDown",{duration:250,easing:"ease-out"});c(s)},c=function(s){e(".lp_js_categoryDefaultPriceForm.lp_is-editing").each(function(){u(e(this),!0)}),s.addClass(i.editing),e(i.categoryDefaultPriceShowElements,s).velocity("slideUp",{duration:250,easing:"ease-out"}),i.addCategory.velocity("fadeOut",{duration:250}),e(i.categoryDefaultPriceEditElements,s).velocity("slideDown",{duration:250,easing:"ease-out",complete:function(){e(i.categoryDefaultPriceInput,s).focus()}}),m(s,i.selectCategory,"laterpay_get_categories_with_price",f)},p=function(s){var a=t(s);e(i.categoryDefaultPriceInput,s).val(a),e.post(ajaxurl,s.serializeArray(),function(t){t.success&&(e(i.categoryDefaultPriceDisplay,s).text(t.localized_price).data("price",t.price),e(i.revenueModelLabelDisplay,s).text(t.revenue_model_label).data("revenue",t.revenue_model),e(i.categoryDefaultPriceInput,s).val(t.price),e(i.categoryTitle,s).text(t.category),e(i.categoryId,s).val(t.category_id),s.removeClass(i.unsaved)),u(s),i.navigation.showMessage(t)},"json")},u=function(s,t){if(s.removeClass(i.editing),s.hasClass(i.unsaved))s.velocity("slideUp",{duration:250,easing:"ease-out",complete:function(){e(this).remove(),0===e(i.categoryDefaultPriceForm+":visible").length&&e(i.emptyState,i.categoryDefaultPrices).velocity("fadeIn",{duration:400})}});else{e(i.categoryDefaultPriceEditElements,s).velocity("slideUp",{duration:250,easing:"ease-out"}),e(i.selectCategory,s).select2("destroy"),e(i.categoryDefaultPriceInput,s).val(e(i.categoryDefaultPriceDisplay,s).data("price"));var a=e(i.revenueModelLabelDisplay,s).data("revenue");e(i.revenueModelLabel,s).removeClass(i.selected),e(".lp_js_revenueModelInput[value="+a+"]",s).prop("checked","checked").parent("label").addClass(i.selected),e(i.categoryDefaultPriceShowElements,s).velocity("slideDown",{duration:250,easing:"ease-out"})}t||i.addCategory.velocity("fadeIn",{duration:250,display:"inline-block"})},d=function(s){t(s,!1,e("input[name=price]",s)),e("input[name=form]",s).val("price_category_form_delete"),e.post(ajaxurl,s.serializeArray(),function(t){t.success&&s.velocity("slideUp",{duration:250,easing:"ease-out",complete:function(){e(this).remove(),0===e(i.categoryDefaultPriceForm+":visible").length&&e(i.emptyState,i.categoryDefaultPrices).velocity("fadeIn",{duration:400})}}),i.navigation.showMessage(t)},"json")},f=function(i,s){var t=e(s).parent().parent().parent();return e(".lp_js_selectCategory",t).val(i.text),e(".lp_js_categoryDefaultPriceCategoryId",t).val(i.id),i.text},_=function(s,t){var a=e(t).parents("form"),r=i.timepass;return e(a).hasClass(i.subscription.classes.editorForm)&&(r=i.subscription),s.id&&e(r.fields.categoryId,e(a)).val(s.id),e(r.fields.scopeCategory,e(a)).val(s.text),s.text},m=function(i,s,t,a){e(s,i).select2({allowClear:!0,ajax:{url:ajaxurl,data:function(e){return{form:t,term:e,action:"laterpay_pricing"}},results:function(i){var s=[];return e.each(i.categories,function(e){var t=i.categories[e];s.push({id:t.term_id,text:t.name})}),{results:s}},dataType:"json",type:"POST"},initSelection:function(i,s){var a=e(i).val();if(""!==a){var r={text:a};s(r)}else e.post(ajaxurl,{form:t,term:"",action:"laterpay_pricing"},function(e){if(e&&void 0!==e[0]){var i=e[0];s({id:i.term_id,text:i.name})}})},formatResult:function(e){return e.text},formatSelection:a,escapeMarkup:function(e){return e}})},v=function(s){var t=i[s];t.actions.create.velocity("fadeOut",{duration:250}),e(i.emptyState,t.editor).is(":visible")&&e(i.emptyState,t.editor).velocity("fadeOut",{duration:400}),e(t.wrapper).first().before(t.template.clone().removeAttr("id"));var a=e(t.wrapper,t.editor).first();e(t.form,a).addClass(i.unsaved),y(s,a),a.velocity("slideDown",{duration:250,easing:"ease-out",complete:function(){e(this).removeClass(i.hidden)}}).find(t.form).velocity("slideDown",{duration:250,easing:"ease-out",complete:function(){e(this).removeClass(i.hidden)}})},h=function(s,t){var a=i[s],r=e(a.form,a.template).clone();e(a.editorContainer,t).html(r),y(s,t),e(a.actions.modify,t).addClass(i.hidden),e(a.actions.show,t).removeClass(i.hidden),r.removeClass(i.hidden)},y=function(s,a){var r=i[s],o=a.data(r.data.id),n=r.data.list[o],l="";if(n){if(e("input, select, textarea",a).each(function(i,s){l=e(s,a).attr("name"),""!==l&&void 0!==n[l]&&"revenue_model"!==l&&e(s,a).val(n[l])}),"timepass"===s){var c=r.data.vouchers[o];t(a.find("form"),!1,e(r.fields.price,a)),e(i.voucherPriceInput,a).val(e(r.fields.price,a).val()),e(i.revenueModelLabel,a).removeClass(i.selected);var p=e(r.fields.revenueModel+"[value="+n.revenue_model+"]",a);p.prop("checked","checked"),p.parent("label").addClass(i.selected),T(a),c instanceof Object&&e.each(c,function(e,i){S(e,i,a)})}else"subscription"===s&&t(a.find("form"),!0,e(r.fields.price,a));e(r.categoryWrapper,a).hide(),m(a,r.fields.scopeCategory,"laterpay_get_categories",_);var u=e(r.fields.scope,a).find("option:selected");"0"!==u.val()&&e(r.categoryWrapper,a).show()}},g=function(s,t,a){var r=i[s],o=""!==a.val()?a.val():" ";if(a.hasClass(r.classes.durationClass)||a.hasClass(r.classes.periodClass)){var n=e(r.fields.duration,t).val(),l=e(r.fields.period,t).find("option:selected").text();l=parseInt(n,10)>1?l+"s":l,o=n+" "+l,e(r.preview.validity,t).text(o),"subscription"===s&&e(r.preview.renewal,t).text(lpVars.i18n.after+" "+o)}else if(a.hasClass(r.classes.scopeClass)||a.hasClass(r.classes.scopeCategoryClass)){var c=e(r.fields.scope,t).find("option:selected");o=c.text(),"0"!==c.val()&&(o+=" "+e(r.fields.scopeCategory,t).val()),e(r.preview.access,t).text(o)}else a.hasClass(r.classes.priceClass)?(e(".lp_js_purchaseLink",t).html(o+'<small class="lp_purchase-link__currency">'+lpVars.currency.code+"</small>"),e(r.preview.price).text(o+" "+lpVars.currency.code)):a.hasClass(r.classes.titleClass)?e(r.preview.title,t).text(o):a.hasClass(r.classes.descriptionClass)&&e(r.preview.description,t).text(o)},b=function(s,t){var a=i[s],r=t.find(a.preview.wrapper).data(a.data.id);e(a.form,t).hasClass(i.unsaved)?t.velocity("fadeOut",{duration:250,complete:function(){e(this).remove(),0===e(a.wrapper+":visible").length&&e(i.emptyState,a.editor).velocity("fadeIn",{duration:400})}}):e(a.form,t).velocity("fadeOut",{duration:250,complete:function(){e(this).remove()}}),e(a.actions.modify,t).removeClass(i.hidden),e(a.actions.show,t).addClass(i.hidden),"timepass"===s&&(T(t),a.data.vouchers[r]instanceof Object&&(e.each(a.data.vouchers[r],function(e,i){k(e,i,t)}),t.find(i.voucherList).show())),a.actions.create.is(":hidden")&&a.actions.create.velocity("fadeIn",{duration:250,display:"inline-block"})},P=function(s,t){var a=i[s];e.post(ajaxurl,e(a.form,t).serializeArray(),function(r){if(r.success){var o=r.data[a.data.fields.id];"timepass"===s&&(a.data.vouchers[o]=r.vouchers),a.data.list[o]||(t.data(a.data.id,o),e(a.id,t).text(o).parent().velocity("fadeIn",{duration:250})),a.data.list[o]=r.data,e(a.preview.placeholder,t).html(r.html),e(a.actions.show,t).addClass(i.hidden),e(a.actions.modify,t).removeClass(i.hidden),e(a.form,t).velocity("fadeOut",{duration:250,complete:function(){e(this).remove(),"timepass"===s&&I(t,a,o)}}),a.actions.create.is(":hidden")&&a.actions.create.velocity("fadeIn",{duration:250,display:"inline-block"})}i.navigation.showMessage(r)},"json")},j=function(s,t){var a=i[s];confirm(a.data.deleteConfirm)&&t.velocity("slideUp",{duration:250,easing:"ease-out",begin:function(){e.post(ajaxurl,{action:"laterpay_pricing",form:a.ajax.form["delete"],id:t.data(a.data.id)},function(s){s.success?(t.remove(),0===e(a.wrapper+":visible").length&&(e(i.emptyState,a.editor).velocity("fadeIn",{duration:400}),i.purchaseModeInput.prop("checked")&&i.purchaseModeInput.prop("checked",!1).change())):e(this).stop().show(),i.navigation.showMessage(s)},"json")}})},D=function(s,t){e(t).parents(i[s].preview.wrapper).toggleClass("lp_is-flipped")},w=function(s,t){var a=i[s],r=e("option:selected",t).val();"0"===r?e(a.categoryWrapper).hide():e(a.categoryWrapper).show()},C=function(s,t,a){var r,o=i[s],n="",l=24,c=t.val(),p=e(o.fields.duration,a).val();for("4"===c?l=1:"3"===c&&(l=12),r=1;r<=l;r++)n+='<option value="'+r+'">'+r+"</option>";e(o.fields.duration,a).find("option").remove().end().append(n).val(p&&p<=l?p:1)},I=function(s,t,a){T(s),t.data.vouchers[a]instanceof Object&&(e.each(t.data.vouchers[a],function(e,i){k(e,i,s)}),s.find(i.voucherList).show())},x=function(s){e.post(ajaxurl,{form:"generate_voucher_code",action:"laterpay_pricing",price:s.find(i.voucherPriceInput).val()},function(e){e.success?S(e.code,s.find(i.voucherPriceInput).val(),s):i.navigation.showMessage(e)},"json")},S=function(e,s,t){var a=s.price?s.price:s,r=a+" "+lpVars.currency.code,o=s.title?s.title:"",n='<div class="lp_js_voucher lp_voucher" data-code="'+e+'" style="display:none;"><input type="hidden" name="voucher_code[]" value="'+e+'"><input type="hidden" name="voucher_price[]" value="'+a+'"><span class="lp_voucher__code">'+e+'</span> <span class="lp_voucher__code-infos">'+lpVars.i18n.voucherText+" "+r+'</span><input class="lp_input__title" type="text" name="voucher_title[]" value="'+o+'"><a href="#" class="lp_js_deleteVoucher lp_edit-link--bold" data-icon="g"></a></div>';t.find(i.voucherPlaceholder).prepend(n).find("div").first().velocity("slideDown",{duration:250,easing:"ease-out"})},k=function(e,s,t){var a=t.data(i.timepass.data.id),r=lpVars.vouchers_statistic[a]?lpVars.vouchers_statistic[a]:0,o=s.title?s.title:"",n=s.price+" "+lpVars.currency.code,l='<div class="lp_js_voucher lp_voucher" data-code="'+e+'"><span class="lp_voucher__title"><b>'+o+'</b></span><div><span class="lp_voucher__code">'+e+'</span><span class="lp_voucher__code-infos">'+lpVars.i18n.voucherText+" "+n+'.<br><span class="lp_js_voucherTimesRedeemed">'+r+"</span> "+lpVars.i18n.timesRedeemed+"</span></div></div>";t.find(i.voucherList).append(l)},T=function(e){e.find(i.voucher).remove()},M=function(i){i.velocity("slideUp",{duration:250,easing:"ease-out",complete:function(){e(this).remove()}})},E=function(s){var t=s.serialize();i.purchaseModeInput.prop("disabled",!0),e.post(ajaxurl,t,function(e){e.success||(i.navigation.showMessage(e),i.purchaseModeInput.prop("checked",!1))},"json"),i.purchaseModeInput.prop("disabled",!1)},V=function(e,i){var s;return function(){var t=this,a=arguments;clearTimeout(s),s=setTimeout(function(){e.apply(t,a)},i)}},F=function(){s()};F()}i()})}(jQuery);